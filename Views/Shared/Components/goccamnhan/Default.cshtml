@model List<websitebenhvien.Models.EnitityVM.ReceivingAngleVM>

@{
    ViewData["Title"] = "Cảm nhận khách hàng về Bệnh viện";
    ViewData["Description"] = "Đọc những chia sẻ chân thành từ bệnh nhân và gia đình về chất lượng dịch vụ y tế tại bệnh viện của chúng tôi";
    ViewData["Keywords"] = "cảm nhận bệnh nhân, đánh giá bệnh viện, phản hồi khách hàng, chất lượng y tế, dịch vụ bệnh viện";
}

@if (Model != null && Model.Any())
{
    <!-- Customer Feedback Section - SEO Optimized -->
    <section id="customer-testimonials" class="customer-feedback-section py-5" itemscope itemtype="https://schema.org/MedicalOrganization">
        <div class="container">
            <!-- SEO Header Section -->
            <header class="section-header text-center mb-5">
                <div class="breadcrumb-seo d-none">
                    <span itemscope itemtype="https://schema.org/BreadcrumbList">
                        <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                            <a itemprop="item" href="/"><span itemprop="name">Trang chủ</span></a>
                            <meta itemprop="position" content="1" />
                        </span>
                        <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                            <span itemprop="name">Cảm nhận khách hàng</span>
                            <meta itemprop="position" content="2" />
                        </span>
                    </span>
                </div>

                <div class="header-badge animate__animated animate__fadeInUp">
                    <i class="fas fa-heart-pulse me-2"></i>
                    <span>Góc cảm nhận</span>
                </div>
                
                <h1 class="section-title animate__animated animate__fadeInUp animate__delay-1s">
                    Cảm Nhận Khách Hàng Về Bệnh Viện
                </h1>
                
                <p class="section-subtitle animate__animated animate__fadeInUp animate__delay-2s">
                    Những chia sẻ chân thành từ bệnh nhân và gia đình về chất lượng dịch vụ y tế, 
                    sự chăm sóc tận tâm và môi trường thân thiện tại bệnh viện của chúng tôi
                </p>

                <!-- Trust Indicators -->
               

                <div class="title-decoration">
                    <div class="decoration-line"></div>
                    <div class="decoration-heart">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="decoration-line"></div>
                </div>
            </header>

            <!-- Filter Controls -->
            <div class="filter-controls mb-4">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="filter-tabs">
                            <button class="filter-btn active" data-filter="all">
                                <i class="fas fa-th-large me-2"></i>Tất cả (@Model.Count)
                            </button>
                            <button class="filter-btn" data-filter="recent">
                                <i class="fas fa-clock me-2"></i>Mới nhất
                            </button>
                            <button class="filter-btn" data-filter="featured">
                                <i class="fas fa-star me-2"></i>Nổi bật
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="view-options">
                            <button class="view-btn active" data-view="grid" title="Xem dạng lưới">
                                <i class="fas fa-th"></i>
                            </button>
                            <button class="view-btn" data-view="list" title="Xem dạng danh sách">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testimonials Grid -->
            <div class="testimonials-grid" id="testimonialsGrid">
                <div class="row g-4">
                    @for (int i = 0; i < Model.Count; i++)
                    {
                        var item = Model[i];
                        var animationDelay = (i % 6) * 100; // Stagger animation
                        
                        <div class="col-lg-6 col-md-6 testimonial-item" 
                             data-category="@(i < 3 ? "featured" : "all")"
                             data-date="@item.created_at.ToString("yyyy-MM-dd")"
                             style="animation-delay: @(animationDelay)ms;">
                            
                            <article class="testimonial-card h-100" 
                                     itemscope 
                                     itemtype="https://schema.org/Review">
                                
                                <!-- Hidden Schema.org Data -->
                                <div class="d-none" itemprop="itemReviewed" itemscope itemtype="https://schema.org/MedicalOrganization">
                                    <span itemprop="name">Bệnh viện</span>
                                </div>
                                
                                <div class="card h-100 testimonial-card-inner">
                                    <div class="row g-0 h-100">
                                        <!-- Image Section -->
                                        <div class="col-md-5">
                                            <div class="testimonial-image-wrapper">
                                                @if (!string.IsNullOrEmpty(item.image))
                                                {
                                                    <img src="~/Resources/@item.image" 
                                                         alt="Cảm nhận của @item.title" 
                                                         class="testimonial-image"
                                                         loading="lazy"
                                                         itemprop="image" />
                                                }
                                                else
                                                {
                                                    <div class="testimonial-placeholder">
                                                        <i class="fas fa-user-injured"></i>
                                                        <span>@item.title.Substring(0, 1).ToUpper()</span>
                                                    </div>
                                                }
                                                
                                                <!-- Verified Badge -->
                                                <div class="verified-badge">
                                                    <i class="fas fa-check-circle"></i>
                                                    <span>Xác thực</span>
                                                </div>
                                                
                                                <!-- Rating Overlay -->
                                                <div class="rating-overlay">
                                                    <div class="stars" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">
                                                        <meta itemprop="ratingValue" content="5" />
                                                        <meta itemprop="bestRating" content="5" />
                                                        @for (int star = 1; star <= 5; star++)
                                                        {
                                                            <i class="fas fa-star"></i>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Content Section -->
                                        <div class="col-md-7">
                                            <div class="card-body d-flex flex-column h-100">
                                                <!-- Quote Icon -->
                                                <div class="quote-icon">
                                                    <i class="fas fa-quote-left"></i>
                                                </div>

                                                <!-- Customer Info -->
                                                <div class="customer-info mb-3">
                                                    <h3 class="customer-name" itemprop="author">@item.title</h3>
                                                    <div class="customer-meta">
                                                        <time class="feedback-date" 
                                                              datetime="@item.created_at.ToString("yyyy-MM-dd")"
                                                              itemprop="datePublished">
                                                            <i class="fas fa-calendar-check me-2"></i>
                                                            @item.created_at.ToString("dd/MM/yyyy")
                                                        </time>
                                                        <span class="patient-type">
                                                            <i class="fas fa-user-check me-1"></i>
                                                            Bệnh nhân thực
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- Review Content -->
                                                <div class="review-content flex-grow-1" itemprop="reviewBody">
                                                    @if (!string.IsNullOrEmpty(item.description))
                                                    {
                                                        <p class="review-text">@Html.Raw(item.description.Replace("\n", "<br/>"))</p>
                                                    }
                                                    else
                                                    {
                                                        <p class="review-text">
                                                            "Tôi và gia đình rất hài lòng với chất lượng dịch vụ y tế tại bệnh viện. 
                                                            Đội ngũ bác sĩ, điều dưỡng chuyên nghiệp, tận tâm và luôn lắng nghe bệnh nhân."
                                                        </p>
                                                    }
                                                </div>

                                                <!-- Tags -->
                                                <div class="review-tags mb-3">
                                                    <span class="tag">
                                                        <i class="fas fa-user-md me-1"></i>
                                                        Bác sĩ chuyên nghiệp
                                                    </span>
                                                    <span class="tag">
                                                        <i class="fas fa-heart me-1"></i>
                                                        Chăm sóc tận tâm
                                                    </span>
                                                </div>

                                                <!-- Action Buttons -->
                                                <div class="testimonial-actions">
                                                    @if (!string.IsNullOrEmpty(item.link))
                                                    {
                                                        <a href="@item.link" 
                                                           target="_blank" 
                                                           rel="noopener noreferrer"
                                                           class="btn btn-outline-primary btn-sm">
                                                            <i class="fas fa-external-link-alt me-2"></i>
                                                            Xem chi tiết
                                                        </a>
                                                    }
                                                    
                                                    <button class="btn btn-primary btn-sm" 
                                                            onclick="showTestimonialModal(@item.id, '@Html.Raw(Html.Encode(item.title))', '@Html.Raw(Html.Encode(item.description ?? ""))', '@item.image', '@item.created_at.ToString("dd/MM/yyyy")')">
                                                        <i class="fas fa-eye me-2"></i>
                                                        Chi tiết
                                                    </button>
                                                    
                                                    <button class="btn btn-success btn-sm" onclick="contactHospital()">
                                                        <i class="fas fa-phone me-2"></i>
                                                        Liên hệ
                                                    </button>
                                                </div>

                                                <!-- Interaction Buttons -->
                                               
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </div>
                    }
                </div>
            </div>

            <!-- Load More Button -->
            <div class="text-center mt-5">
                <button class="btn btn-outline-primary btn-lg load-more-btn" id="loadMoreBtn">
                    <i class="fas fa-plus me-2"></i>
                    Xem thêm cảm nhận
                </button>
            </div>

            <!-- Statistics Section -->
    
            <!-- Call to Action -->
           
        </div>
    </section>

    <!-- Testimonial Detail Modal -->
   

    <!-- CSS Styles -->
    <style>
        .customer-feedback-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .customer-feedback-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%);
            pointer-events: none;
        }

        .section-header {
            position: relative;
            z-index: 10;
        }

        .header-badge {
            display: inline-flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.15);
            padding: 12px 30px;
            border-radius: 50px;
            color: white;
            font-weight: 600;
            margin-bottom: 25px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .section-title {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 800;
            color: white;
            margin-bottom: 25px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .section-subtitle {
            font-size: clamp(1.1rem, 2.5vw, 1.4rem);
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 35px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .trust-indicators {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .trust-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 24px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .title-decoration {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .decoration-line {
            width: 80px;
            height: 3px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 2px;
        }

        .decoration-heart {
            background: rgba(255, 255, 255, 0.15);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            backdrop-filter: blur(10px);
            animation: heartbeat 2s ease-in-out infinite;
        }

        @@keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .filter-controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            margin-bottom: 40px;
        }

        .filter-btn, .view-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .filter-btn.active, .view-btn.active {
            background: white;
            color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .testimonials-grid {
            position: relative;
            z-index: 10;
        }

        .testimonial-item {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.8s ease forwards;
        }

        @@keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .testimonial-card-inner {
            border: none;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
        }

        .testimonial-card-inner:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.2);
        }

        .testimonial-image-wrapper {
            position: relative;
            height: 100%;
            min-height: 300px;
            overflow: hidden;
        }

        .testimonial-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .testimonial-card-inner:hover .testimonial-image {
            transform: scale(1.05);
        }

        .testimonial-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: white;
            font-size: 3rem;
        }

        .testimonial-placeholder span {
            font-size: 4rem;
            font-weight: 700;
            margin-top: 15px;
        }

        .verified-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .rating-overlay {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .rating-overlay .stars i {
            color: #ffc107;
            font-size: 0.9rem;
            margin-right: 2px;
        }

        .quote-icon {
            color: #667eea;
            opacity: 0.2;
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .customer-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .customer-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 0.9rem;
            color: #6c757d;
        }

        .patient-type {
            color: #28a745;
            font-weight: 600;
        }

        .review-text {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #495057;
            font-style: italic;
            margin-bottom: 0;
        }

        .review-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            background: #e8f2ff;
            color: #667eea;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .testimonial-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .testimonial-actions .btn {
            border-radius: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .testimonial-actions .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .interaction-buttons {
            display: flex;
            gap: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }

        .interaction-btn {
            background: none;
            border: none;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .interaction-btn:hover {
            background: #f8f9fa;
            color: #667eea;
            transform: translateY(-1px);
        }

        .load-more-btn {
            border-radius: 50px;
            padding: 15px 40px;
            font-weight: 600;
            transition: all 0.4s ease;
        }

        .load-more-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .statistics-section {
            margin-top: 80px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.4s ease;
            backdrop-filter: blur(20px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.2);
        }

        .stat-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #6c757d;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .cta-section {
            margin-top: 80px;
        }

        .cta-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 60px 40px;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .cta-card h3 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .cta-card p {
            font-size: 1.2rem;
            color: #6c757d;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .modal-content {
            border-radius: 25px;
            border: none;
            overflow: hidden;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 30px;
        }

        .modal-header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            width: 100%;
        }

        .modal-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .modal-rating .stars i {
            color: #ffc107;
            margin-right: 2px;
        }

        /* Hide modal backdrop */
        .modal-backdrop {
            display: none !important;
        }

        /* Alternative: Make backdrop transparent */
        .modal-backdrop.fade.show {
            opacity: 0 !important;
            background: transparent !important;
        }

        /* Ensure modal still works without backdrop */
        .modal.show .modal-dialog {
            transform: none;
        }

        /* Responsive Design */
        @@media (max-width: 768px) {
            .section-title {
                font-size: 2.5rem;
            }
            
            .trust-indicators {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .filter-controls .row {
                text-align: center;
            }
            
            .testimonial-image-wrapper {
                min-height: 250px;
            }
            
            .customer-meta {
                font-size: 0.85rem;
            }
            
            .testimonial-actions {
                justify-content: center;
            }
            
            .interaction-buttons {
                justify-content: center;
            }
            
            .cta-card {
                padding: 40px 20px;
            }
            
            .cta-card h3 {
                font-size: 2rem;
            }
            
            .modal-header {
                padding: 20px;
            }
            
            .modal-header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
        }

        @@media (max-width: 576px) {
            .section-title {
                font-size: 2rem;
            }
            
            .testimonial-card-inner .row {
                flex-direction: column;
            }
            
            .testimonial-image-wrapper {
                min-height: 200px;
            }
            
            .customer-name {
                font-size: 1.2rem;
            }
            
            .review-text {
                font-size: 1rem;
            }
            
            .stat-number {
                font-size: 2.5rem;
            }
        }
    </style>

    <!-- JavaScript -->
    <script>
        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all buttons
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');
                
                const filter = this.getAttribute('data-filter');
                filterTestimonials(filter);
            });
        });

        function filterTestimonials(filter) {
            const items = document.querySelectorAll('.testimonial-item');
            
            items.forEach(item => {
                if (filter === 'all') {
                    item.style.display = 'block';
                } else if (filter === 'recent') {
                    // Show items from last 30 days (simplified logic)
                    const itemDate = new Date(item.getAttribute('data-date'));
                    const thirtyDaysAgo = new Date();
                    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                    item.style.display = itemDate >= thirtyDaysAgo ? 'block' : 'none';
                } else if (filter === 'featured') {
                    item.style.display = item.getAttribute('data-category') === 'featured' ? 'block' : 'none';
                }
            });
        }

        // View toggle functionality
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const view = this.getAttribute('data-view');
                toggleView(view);
            });
        });

        function toggleView(view) {
            const grid = document.querySelector('.testimonials-grid .row');
            if (view === 'list') {
                grid.classList.remove('g-4');
                grid.classList.add('g-2');
                document.querySelectorAll('.testimonial-item').forEach(item => {
                    item.className = 'col-12 testimonial-item';
                });
            } else {
                grid.classList.remove('g-2');
                grid.classList.add('g-4');
                document.querySelectorAll('.testimonial-item').forEach(item => {
                    item.className = 'col-lg-6 col-md-6 testimonial-item';
                });
            }
        }

        // Modal functionality
        function showTestimonialModal(id, title, description, image, date) {
            document.getElementById('testimonialModalLabel').textContent = title;
            document.getElementById('modalDate').textContent = date;
            
            const modalAvatar = document.getElementById('modalAvatar');
            if (image) {
                modalAvatar.innerHTML = `<img src="~/Resources/${image}" alt="${title}" style="width: 100%; height: 100%; object-fit: cover;">`;
            } else {
                modalAvatar.innerHTML = `<i class="fas fa-user-injured"></i>`;
            }
            
            document.getElementById('modalBody').innerHTML = `
                <div style="padding: 20px;">
                    <div class="text-center mb-4">
                        <i class="fas fa-quote-left" style="font-size: 3rem; color: #667eea; opacity: 0.3;"></i>
                    </div>
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #495057; text-align: justify;">
                        ${description || 'Tôi và gia đình rất hài lòng với chất lượng dịch vụ y tế tại bệnh viện.'}
                    </p>
                    <div class="text-center mt-4">
                        <div class="stars">
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                        </div>
                        <p class="mt-2 text-muted">Đánh giá: 5/5 sao</p>
                    </div>
                </div>`;
            
            new bootstrap.Modal(document.getElementById('testimonialModal')).show();
        }

        // Interaction functions
        function likeTestimonial(btn) {
            const countEl = btn.querySelector('.count');
            const currentCount = parseInt(countEl.textContent);
            countEl.textContent = currentCount + 1;
            
            btn.style.color = '#dc3545';
            btn.style.animation = 'heartbeat 0.6s ease-in-out';
            
            setTimeout(() => {
                btn.style.animation = '';
            }, 600);
        }

        function shareTestimonial() {
            if (navigator.share) {
                navigator.share({
                    title: 'Cảm nhận khách hàng',
                    text: 'Xem cảm nhận của bệnh nhân về bệnh viện',
                    url: window.location.href
                });
            } else {
                // Fallback for browsers that don't support Web Share API
                navigator.clipboard.writeText(window.location.href);
                alert('Đã sao chép link để chia sẻ!');
            }
        }

        function thankCustomer() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-heart me-2"></i>Đã cảm ơn!';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 3000);
        }

        function shareModal() {
            shareTestimonial();
        }

        function contactHospital() {
            window.open('tel:+84123456789', '_blank');
        }

        function openFeedbackForm() {
            window.location.href = '/feedback/create';
        }

        // Counter animation for statistics
        function animateCounter(element) {
            const target = parseFloat(element.getAttribute('data-target'));
            let current = 0;
            const increment = target / 60;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = target % 1 !== 0 ? target.toFixed(1) : Math.ceil(target);
                    clearInterval(timer);
                } else {
                    element.textContent = target % 1 !== 0 ? current.toFixed(1) : Math.floor(current);
                }
            }, 30);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Animate counters when they come into view
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const counters = entry.target.querySelectorAll('.stat-number');
                        counters.forEach(counter => {
                            if (!counter.classList.contains('animated')) {
                                animateCounter(counter);
                                counter.classList.add('animated');
                            }
                        });
                    }
                });
            }, { threshold: 0.5 });
            
            const statsSection = document.querySelector('.statistics-section');
            if (statsSection) {
                observer.observe(statsSection);
            }
            
            // Load more functionality
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', function() {
                    // Simulate loading more testimonials
                    this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang tải...';
                    
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-check me-2"></i>Đã tải tất cả';
                        this.disabled = true;
                    }, 2000);
                });
            }
        });
    </script>
}
else
{
    <!-- Empty State -->
    <section class="customer-feedback-section py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 60vh;">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <div style="padding: 80px 20px;">
                        <div style="background: rgba(255, 255, 255, 0.1); width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px; backdrop-filter: blur(10px);">
                            <i class="fas fa-comments fa-4x text-white"></i>
                        </div>
                        <h2 class="text-white mb-3">Chưa có cảm nhận nào</h2>
                        <p class="text-white-50 mb-4">Các cảm nhận từ khách hàng sẽ được hiển thị tại đây.</p>
                        <button class="btn btn-light btn-lg" onclick="openFeedbackForm()">
                            <i class="fas fa-pen me-2"></i>
                            Viết cảm nhận đầu tiên
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
}
