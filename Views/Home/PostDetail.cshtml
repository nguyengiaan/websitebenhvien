@model websitebenhvien.Models.Enitity.News
@{
    ViewData["Title"] = Model.Title;
    ViewData["Image"] = "/Resources/" + Model.Url;
    ViewData["description"] = Model.Descriptionshort;
    ViewData["keywords"] = Model.Keyword;
    ViewData["Schema"] = Model.SchemaMakup;
    var breadcrumbs = ViewBag.breadcrumbs as List<(string Title, string Url)>;

}

<div class="container mt-5 ">
@if (breadcrumbs != null)
{
    <nav aria-label="breadcrumb" style="z-index: 0 !important;">
        <ol class="breadcrumb bg-transparent px-0">
            @foreach (var crumb in breadcrumbs)
            {
                if (!string.IsNullOrEmpty(crumb.Url))
                {
                    <li class="breadcrumb-item">
                            <a href="@crumb.Url" class="text-decoration-none">@crumb.Title</a>
                    </li>
                }
                else
                {
                    <li class="breadcrumb-item active" aria-current="page">@crumb.Title</li>
                }
            }
        </ol>
    </nav>
}
</div>
<div class="container mt-5">

    <div class="row">
        <!-- Nội dung bài viết -->
        <div class="col-lg-12">
            <article class="post-content bg-white p-4 rounded-3 shadow-sm">
                <h1 class="post-title fw-bold mb-4" id="post-title">
                    @if (Model.Title != null)
                    {
                        @Model.Title
                    }
                    else
                    {
						var data = "Loading....";
						@data
                    }
                    
                    </h1>
                
                <div class="post-meta mb-4 d-flex align-items-center">
                    <span class="me-4 d-flex align-items-center">
                        <i class="far fa-calendar-alt me-2 text-danger"></i>
                        <span class="fw-bold text-danger" id="post-date">
                            @if (Model.Createat != null)
                            {
                                @Model.Createat.ToString("yyyy-MM-dd")
                            }
                            else
                            {
                                var dateData = "Loading....";
                                @dateData
                            }
                        </span>
                    </span>
              
                </div>

              
                <div class="post-body" id="post-body">

				
                    @if (Model.Description != null)
                    {
                        @Html.Raw(Model.Description)
                    }
                    else
                    {
                        var description = "Loading....";
                        @description
                    }
		
                </div>
                <div class="recruitment-form mt-5 bg-white p-5 rounded-4 shadow-lg border" id="recruitment-form">
                    <div class="text-center mb-5">
                        <h3 class="text-primary fw-bold mb-2">Đăng ký ứng tuyển</h3>
                        <p class="text-muted">Hãy điền đầy đủ thông tin bên dưới để ứng tuyển</p>
                    </div>

                    <form id="recruitmentForm" class="needs-validation" novalidate>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control border-0 bg-light" id="Name" name="Name" placeholder="Họ và tên" required>
                                    <label for="Name" class="text-muted">
                                        <i class="far fa-user me-2"></i>Họ và tên
                                    </label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="gender-select bg-light p-3 rounded-3 h-100">
                                    <label class="form-label fw-medium mb-3 text-muted">
                                        <i class="fas fa-venus-mars me-2"></i>Giới tính
                                    </label>
                                    <div class="d-flex gap-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="sex" id="sex" value="Nam" required>
                                            <label class="form-check-label" for="male">Nam</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="sex" id="sex" value="Nữ" required>
                                            <label class="form-check-label" for="female">Nữ</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="tel" class="form-control border-0 bg-light" id="Phone" name="Phone" placeholder="Số điện thoại" required>
                                    <label for="phone" class="text-muted">
                                        <i class="fas fa-phone-alt me-2"></i>Số điện thoại
                                    </label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control border-0 bg-light" id="Position" name="Position" placeholder="Vị trí ứng tuyển" required>
                                    <label for="position" class="text-muted">
                                        <i class="fas fa-briefcase me-2"></i>Vị trí ứng tuyển
                                    </label>git status
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control border-0 bg-light" id="Address" name="Address" placeholder="Địa chỉ" required>
                                    <label for="address" class="text-muted">
                                        <i class="fas fa-map-marker-alt me-2"></i>Địa chỉ
                                    </label>
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="upload-cv p-4 border border-dashed rounded-3 bg-light text-center">
                                    <i class="fas fa-cloud-upload-alt fa-2x text-primary mb-3"></i>
                                    <h6 class="fw-bold mb-2">Tải lên CV của bạn</h6>
                                    <input type="file" class="form-control border-0" id="CV_Url" name="CV_Url" accept=".pdf,.doc,.docx">
                                    <small class="text-muted mt-2 d-block">Chấp nhận file PDF, DOC, DOCX (Tối đa 5MB)</small>
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="form-floating">
                                    <textarea class="form-control border-0 bg-light" id="Note" name="Note" style="height: 120px" placeholder="Thư giới thiệu"></textarea>
                                    <label for="coverLetter" class="text-muted">
                                        <i class="fas fa-envelope me-2"></i>Thư giới thiệu
                                    </label>
                                </div>
                            </div>

                            <div class="col-12 text-center mt-4">
                                <button type="button" onclick="SubmitRecruitment()" class="btn btn-primary btn-lg px-5 py-3 rounded-pill shadow-sm hover-lift">
                                    <i class="fas fa-paper-plane me-2"></i>Gửi đơn ứng tuyển
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </article>

            <div class="share-buttons mt-4 text-center">
                <h5 class="mb-3">Chia sẻ bài viết</h5>
                <a onclick="shareToFacebook()" class="btn btn-primary me-2" style="cursor:pointer"><i class="fab fa-facebook-f me-2"></i>Facebook</a>
                <a href="#" class="btn btn-info me-2"><i class="fab fa-twitter me-2"></i>Twitter</a>
                <a href="#" class="btn btn-danger"><i class="fab fa-pinterest me-2"></i>Pinterest</a>
            </div>

            <!-- Bài viết nổi bật -->
            <div class="featured-posts bg-white p-4 rounded-3 shadow-sm mt-4">
                <h4 class="fw-bold border-bottom pb-3 mb-3 text-center text-danger">Bài viết nổi bật</h4>
                <div id="post-category-news" class="overflow-auto position-relative" style="max-height: 900px;">
                    <div class="scrolling-wrapper d-flex flex-row" style="animation: scroll-left 20s linear infinite;">
                        <!-- Nội dung bài viết sẽ được thêm vào đây qua JavaScript -->
                    </div>
                </div>
               
            </div>
        </div>
    </div>
</div>
@section Styles
{
  
 <link rel="stylesheet" type="text/css" href="~/css/tintuc.css">

}


@section Scripts{
    <script>
    var breadcrumbs = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(breadcrumbs));
        console.log(breadcrumbs);
        $(document).ready(function(){
           
  
            GetNewsByCategory();
           GetNewsById();

        });

        function shareToFacebook() {
            var currentUrl = window.location.href;
            var facebookShareUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(currentUrl);
            window.open(facebookShareUrl, '_blank', 'width=600,height=400');
        }
        function GetNewsById() {


    
        
            $('#post-body').html(postData.description).css({
                'font-size': '14px',
                'padding': '10px', 
                'word-wrap': 'break-word',
                'max-width': '100%'
            }).find('img, table,input[type="image"]').css({
                'max-width': '100%',
                'height': 'auto',
                'object-fit': 'contain'
            });

            $('#post-body table').css({
                'display': 'block',
                'overflow-x': 'auto',
                'width': '100%'
            }).find('td').css({
                'min-width': '120px',
                'white-space': 'nowrap'
            });
}

       function GetNewsByCategory(){
            var currentUrl = window.location.pathname;
            var segments = currentUrl.split('/');
            var alias_url = "/chi-tiet-tin/" + segments[segments.length - 1];
            $.ajax({
                url: "/Post/GetNewsByCategory", 
                type: "POST",
                data: { alias_url: alias_url },
                success: function(response){
                   if(response.status){
                        var html = '<div id="relatedPostCarousel" class="carousel slide" data-bs-ride="carousel">';
                        html += '<div class="carousel-inner">';
                        
                        console.log(response.data);
                        
                        // Group posts into sets of 3
                        for(var i = 0; i < response.data.length; i += 3) {
                            var isActive = i === 0 ? 'active' : '';
                            html += `<div class="carousel-item ${isActive}"><div class="row">`;
                            
                            // Add up to 3 posts per slide
                            for(var j = i; j < Math.min(i + 3, response.data.length); j++) {
                                var item = response.data[j];
                                var postDate = new Date(item.createat).toLocaleDateString();
                                var today = new Date().toLocaleDateString();
                                var isNew = postDate === today;
                                
                                html += `
                                    <div class="col-md-4">
                                        <div class="featured-post-item mb-4 bg-white rounded-3 shadow-hover" 
                                             style="transition: all 0.3s ease;">
                                            <a href="${item.alias_url}" class="text-decoration-none">
                                                <div class="position-relative">
                                                    <img src="/Resources/${item.url}" 
                                                         class="img-fluid w-100 rounded-top" 
                                                         alt="${item.title}"
                                                         style="height: 200px; object-fit: cover;">
                                                    ${isNew ? '<span class="badge bg-danger position-absolute top-0 end-0 m-2">Mới</span>' : ''}
                                                </div>
                                                <div class="p-3" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef);">
                                                    <h6 class="text-dark mb-2 fw-bold" 
                                                        style="display: -webkit-box;
                                                               -webkit-line-clamp: 2;
                                                               -webkit-box-orient: vertical;
                                                               overflow: hidden;
                                                               line-height: 1.5;
                                                               height: 3em;
                                                               color: #2c3e50;">
                                                        ${item.title}
                                                    </h6>
                                                    <div class="d-flex align-items-center">
                                                        <i class="far fa-calendar-alt text-danger me-2"></i>
                                                        <span class="text-muted small" style="color: #6c757d !important;">${item.createat.split('T')[0]}</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                `;
                            }
                            
                            html += '</div></div>';
                        }
                        
                        html += '</div>';
                        
                        // Add carousel controls
                        html += `
                            <button class="carousel-control-prev" type="button" data-bs-target="#relatedPostCarousel" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#relatedPostCarousel" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        `;
                        
                        html += '</div>';

                        if(response.data[0].id_Categorynews ==='4016460a-bf7a-4b41-9ff2-4e1cb4cbdf28'){
                            $('#recruitment-form').show();
                        }else{
                            $('#recruitment-form').hide();
                        }
                        $('#post-category-news').html(html);

                        // Add hover effects via CSS
                        $("<style>")
                            .text(`
                                .shadow-hover {
                                    border: 1px solid #e0e0e0;
                                    background: linear-gradient(135deg, #ffffff, #f8f9fa);
                                }
                                .shadow-hover:hover {
                                    transform: translateY(-5px);
                                    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
                                    border-color: #007bff;
                                }
                                .featured-post-item:hover h6 {
                                    color: #007bff !important;
                                    text-shadow: 0 0 1px rgba(0,123,255,0.1);
                                }
                                .featured-post-item img {
                                    transition: all 0.4s ease;
                                }
                                .featured-post-item:hover img {
                                    transform: scale(1.05);
                                    filter: brightness(1.05);
                                }
                                .badge {
                                    background: linear-gradient(45deg, #dc3545, #ff4d5a) !important;
                                    box-shadow: 0 2px 4px rgba(220,53,69,0.3);
                                }
                                .featured-post-item {
                                    border-radius: 10px;
                                    overflow: hidden;
                                }
                                .carousel-control-prev,
                                .carousel-control-next {
                                    width: 40px;
                                    height: 40px;
                                    top: 50%;
                                    transform: translateY(-50%);
                                    background: rgba(0,0,0,0.5);
                                    border-radius: 50%;
                                    margin: 0 10px;
                                }
                                .carousel-control-prev:hover,
                                .carousel-control-next:hover {
                                    background: rgba(0,0,0,0.7);
                                }
                                .carousel-control-prev-icon,
                                .carousel-control-next-icon {
                                    width: 20px;
                                    height: 20px;
                                }
                            `)
                            .appendTo("head");
                   }
                }
            });
        }
       
    </script>
}